<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Frameset//EN""http://www.w3.org/TR/REC-html40/frameset.dtd">
<!--NewPage-->
<HTML>
<HEAD>
<!-- Generated by javadoc on Fri Jun 21 18:01:15 GMT+02:00 2002 -->
<TITLE>
GSM 43.019 v4.2.0 Annex A: Java Card SIM API: Class  EnvelopeHandler
</TITLE>
<LINK REL ="stylesheet" TYPE="text/css" HREF="../../stylesheet.css" TITLE="Style">
</HEAD>
<BODY BGCOLOR="white">

<!-- ========== START OF NAVBAR ========== -->
<A NAME="navbar_top"><!-- --></A>
<TABLE BORDER="0" WIDTH="100%" CELLPADDING="1" CELLSPACING="0">
<TR>
<TD COLSPAN=2 BGCOLOR="#EEEEFF" CLASS="NavBarCell1">
<A NAME="navbar_top_firstrow"><!-- --></A>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="3">
  <TR ALIGN="center" VALIGN="top">
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../overview-summary.html"><FONT CLASS="NavBarFont1"><B>Overview</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-summary.html"><FONT CLASS="NavBarFont1"><B>Package</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#FFFFFF" CLASS="NavBarCell1Rev"> &nbsp;<FONT CLASS="NavBarFont1Rev"><B>Class</B></FONT>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="class-use/EnvelopeHandler.html"><FONT CLASS="NavBarFont1"><B>Use</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-tree.html"><FONT CLASS="NavBarFont1"><B>Tree</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../deprecated-list.html"><FONT CLASS="NavBarFont1"><B>Deprecated</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../index-all.html"><FONT CLASS="NavBarFont1"><B>Index</B></FONT></A>&nbsp;</TD>
  </TR>
</TABLE>
</TD>
<TD ALIGN="right" VALIGN="top" ROWSPAN=3><EM>
</EM>
</TD>
</TR>

<TR>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
&nbsp;<A HREF="../../sim/toolkit/EditHandler.html"><B>PREV CLASS</B></A>&nbsp;
&nbsp;<A HREF="../../sim/toolkit/EnvelopeResponseHandler.html"><B>NEXT CLASS</B></A></FONT></TD>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
  <A HREF="../../index.html" TARGET="_top"><B>FRAMES</B></A>  &nbsp;
&nbsp;<A HREF="EnvelopeHandler.html" TARGET="_top"><B>NO FRAMES</B></A></FONT></TD>
</TR>
<TR>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
  SUMMARY: &nbsp;INNER&nbsp;|&nbsp;FIELD&nbsp;|&nbsp;CONSTR&nbsp;|&nbsp;<A HREF="#method_summary">METHOD</A></FONT></TD>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
DETAIL: &nbsp;FIELD&nbsp;|&nbsp;CONSTR&nbsp;|&nbsp;<A HREF="#method_detail">METHOD</A></FONT></TD>
</TR>
</TABLE>
<!-- =========== END OF NAVBAR =========== -->

<HR>
<!-- ======== START OF CLASS DATA ======== -->
<H2>
<FONT SIZE="-1">
sim.toolkit</FONT>
<BR>
Class  EnvelopeHandler</H2>
<PRE>
java.lang.Object
  |
  +--<A HREF="../../sim/toolkit/ViewHandler.html">sim.toolkit.ViewHandler</A>
        |
        +--<B>sim.toolkit.EnvelopeHandler</B>
</PRE>
<HR>
<DL>
<DT>public final class <B>EnvelopeHandler</B><DT>extends <A HREF="../../sim/toolkit/ViewHandler.html">ViewHandler</A></DL>

<P>
The EnvelopeHandler class contains basic methods to handle the <b>Envelope
 </b>data field. This class will be used by the Toolkit applet in order to
 have access to the current Envelope information. No constructor is available
 for the Toolkit applet. The EnvelopeHandler class is a <b>Temporary JCRE 
 Entry Point Object</b>. The only way to get a EnvelopeHandler reference is 
 through the <code>getTheHandler()</code> static method.<p>

 Toolkit Applet Example:<pre><code>
 private static final byte MY_TAG = (byte)0x54;
 private byte[] data;
 data = new byte[32];

 void processToolkit(byte event) throws ToolkitException {
     // get the EnvelopeHandler system instance
     EnvelopeHandler theEnv = EnvelopeHandler.getTheHandler();
     // look for MY_TAG TLV
     if (theEnv.findTLV(MY_TAG, (byte)1) != TLV_NOT_FOUND) {
         // check first element byte
         if (theEnv.getValueByte((short)0) == (byte)1) {
             // copy element part into data buffer
             theEnv.copyValue((short)1,
                              data,
                              (short)0,
                              (short)(theEnv.getValueLength() - 1));
         }
     }
 }
 </code></pre>
<P>
<DL>
<DT><B>Version: </B><DD>4.2.0</DD>
<DT><B>See Also: </B><DD><A HREF="../../sim/toolkit/ViewHandler.html"><CODE>ViewHandler</CODE></A>, 
<A HREF="../../sim/toolkit/EnvelopeResponseHandler.html"><CODE>EnvelopeResponseHandler</CODE></A>, 
<A HREF="../../sim/toolkit/ProactiveHandler.html"><CODE>ProactiveHandler</CODE></A>, 
<A HREF="../../sim/toolkit/ToolkitException.html"><CODE>ToolkitException</CODE></A></DL>
<HR>

<P>
<!-- ======== INNER CLASS SUMMARY ======== -->


<!-- =========== FIELD SUMMARY =========== -->


<!-- ======== CONSTRUCTOR SUMMARY ======== -->


<!-- ========== METHOD SUMMARY =========== -->

<A NAME="method_summary"><!-- --></A>
<TABLE BORDER="1" CELLPADDING="3" CELLSPACING="0" WIDTH="100%">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TD COLSPAN=2><FONT SIZE="+2">
<B>Method Summary</B></FONT></TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;byte</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../sim/toolkit/EnvelopeHandler.html#getEnvelopeTag()">getEnvelopeTag</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Returns the Envelope BER-TLV tag.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;byte</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../sim/toolkit/EnvelopeHandler.html#getItemIdentifier()">getItemIdentifier</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Returns the item identifier byte value from the first Item Identifier TLV
 element in the current Envelope data field.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;short</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../sim/toolkit/EnvelopeHandler.html#getSecuredDataLength()">getSecuredDataLength</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Looks for the length of the Secured Data from the Command Packet in the first SMS TPDU
 or Cell Broadcast Page Simple TLV contained in the Envelope handler.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;short</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../sim/toolkit/EnvelopeHandler.html#getSecuredDataOffset()">getSecuredDataOffset</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Looks for the Secured Data from the Command Packet in the first SMS TPDU 
 or Cell Broadcast Page Simple TLV contained in the Envelope handler.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>static&nbsp;<A HREF="../../sim/toolkit/EnvelopeHandler.html">EnvelopeHandler</A></CODE></FONT></TD>
<TD><CODE><B><A HREF="../../sim/toolkit/EnvelopeHandler.html#getTheHandler()">getTheHandler</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Returns the single system instance of the EnvelopeHandler class.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;short</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../sim/toolkit/EnvelopeHandler.html#getTPUDLOffset()">getTPUDLOffset</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Looks for the TP-UDL field in the first TPDU TLV element in the Envelope
 data field.</TD>
</TR>
</TABLE>
&nbsp;<A NAME="methods_inherited_from_class_sim.toolkit.ViewHandler"><!-- --></A>
<TABLE BORDER="1" CELLPADDING="3" CELLSPACING="0" WIDTH="100%">
<TR BGCOLOR="#EEEEFF" CLASS="TableSubHeadingColor">
<TD><B>Methods inherited from class sim.toolkit.<A HREF="../../sim/toolkit/ViewHandler.html">ViewHandler</A></B></TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD><CODE><A HREF="../../sim/toolkit/ViewHandler.html#compareValue(short, byte[], short, short)">compareValue</A>, <A HREF="../../sim/toolkit/ViewHandler.html#copy(byte[], short, short)">copy</A>, <A HREF="../../sim/toolkit/ViewHandler.html#copyValue(short, byte[], short, short)">copyValue</A>, <A HREF="../../sim/toolkit/ViewHandler.html#findAndCompareValue(byte, byte[], short)">findAndCompareValue</A>, <A HREF="../../sim/toolkit/ViewHandler.html#findAndCompareValue(byte, byte, short, byte[], short, short)">findAndCompareValue</A>, <A HREF="../../sim/toolkit/ViewHandler.html#findAndCopyValue(byte, byte[], short)">findAndCopyValue</A>, <A HREF="../../sim/toolkit/ViewHandler.html#findAndCopyValue(byte, byte, short, byte[], short, short)">findAndCopyValue</A>, <A HREF="../../sim/toolkit/ViewHandler.html#findTLV(byte, byte)">findTLV</A>, <A HREF="../../sim/toolkit/ViewHandler.html#getLength()">getLength</A>, <A HREF="../../sim/toolkit/ViewHandler.html#getValueByte(short)">getValueByte</A>, <A HREF="../../sim/toolkit/ViewHandler.html#getValueLength()">getValueLength</A></CODE></TD>
</TR>
</TABLE>
&nbsp;<A NAME="methods_inherited_from_class_java.lang.Object"><!-- --></A>
<TABLE BORDER="1" CELLPADDING="3" CELLSPACING="0" WIDTH="100%">
<TR BGCOLOR="#EEEEFF" CLASS="TableSubHeadingColor">
<TD><B>Methods inherited from class java.lang.Object</B></TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD><CODE>equals</CODE></TD>
</TR>
</TABLE>
&nbsp;
<P>

<!-- ============ FIELD DETAIL =========== -->


<!-- ========= CONSTRUCTOR DETAIL ======== -->


<!-- ============ METHOD DETAIL ========== -->

<A NAME="method_detail"><!-- --></A>
<TABLE BORDER="1" CELLPADDING="3" CELLSPACING="0" WIDTH="100%">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TD COLSPAN=1><FONT SIZE="+2">
<B>Method Detail</B></FONT></TD>
</TR>
</TABLE>

<A NAME="getTheHandler()"><!-- --></A><H3>
getTheHandler</H3>
<PRE>
public static <A HREF="../../sim/toolkit/EnvelopeHandler.html">EnvelopeHandler</A> <B>getTheHandler</B>()
                                     throws <A HREF="../../sim/toolkit/ToolkitException.html">ToolkitException</A></PRE>
<DL>
<DD>Returns the single system instance of the EnvelopeHandler class.
 The applet shall get the reference of the handler at its triggering, 
 the beginning of the processToolkit method.<DD><DL>
<DT><B>Returns:</B><DD>reference of the system instance<DT><B>Throws:</B><DD><CODE><A HREF="../../sim/toolkit/ToolkitException.html">ToolkitException</A></CODE> - with the following reason codes: <ul>
      <li><code>HANDLER_NOT_AVAILABLE</code> if the handler is busy.</ul></DL>
</DD>
</DL>
<HR>

<A NAME="getEnvelopeTag()"><!-- --></A><H3>
getEnvelopeTag</H3>
<PRE>
public byte <B>getEnvelopeTag</B>()</PRE>
<DL>
<DD>Returns the Envelope BER-TLV tag.<DD><DL>
<DT><B>Returns:</B><DD>Envelope BER-TLV tag</DL>
</DD>
</DL>
<HR>

<A NAME="getTPUDLOffset()"><!-- --></A><H3>
getTPUDLOffset</H3>
<PRE>
public short <B>getTPUDLOffset</B>()
                     throws <A HREF="../../sim/toolkit/ToolkitException.html">ToolkitException</A></PRE>
<DL>
<DD>Looks for the TP-UDL field in the first TPDU TLV element in the Envelope
 data field. This method can be used on the events EVENT_FORMATTED_SMS_PP_ENV,
 EVENT_FORMATTED_SMS_PP_UPD, EVENT_UNFORMATTED_SMS_PP_ENV, EVENT_UNFORMATTED_SMS_PP_UPD.
 If the element is available it becomes the TLV selected.<DD><DL>
<DT><B>Returns:</B><DD>TPUDL offset in the first TPDU TLV element if TPUDL exists.
      The TPUD length can be recovered by using the getValueByte method in Handler class.<DT><B>Throws:</B><DD><CODE><A HREF="../../sim/toolkit/ToolkitException.html">ToolkitException</A></CODE> - with the following reason codes: <ul>
      <li><code>UNAVAILABLE_ELEMENT</code> in case of unavailable TPDU TLV element or if the TPUDL field does not exist</ul></DL>
</DD>
</DL>
<HR>

<A NAME="getSecuredDataOffset()"><!-- --></A><H3>
getSecuredDataOffset</H3>
<PRE>
public short <B>getSecuredDataOffset</B>()
                           throws <A HREF="../../sim/toolkit/ToolkitException.html">ToolkitException</A></PRE>
<DL>
<DD>Looks for the Secured Data from the Command Packet in the first SMS TPDU 
 or Cell Broadcast Page Simple TLV contained in the Envelope handler. This can
 be used on the events:
 - EVENT_FORMATTED_SMS_PP_ENV, EVENT_FORMATTED_SMS_PP_UPD, if the SMS TP-UD is formatted
 according to TS 03.48 Single Short Message.
 - EVENT_FORMATTED_SMS_CB, if the Cell Broadcast Page is formatted according to TS 03.48.
 If the element is available it becomes the TLV selected.<DD><DL>
<DT><B>Returns:</B><DD>the offset of the Secured Data first byte in the first SMS TPDU or Cell Broadcast Page TLV element. If
         the Secured Data length is zero the value returned shall be the offset of the first byte following the 
         TS 03.48 Command.<DT><B>Throws:</B><DD><CODE><A HREF="../../sim/toolkit/ToolkitException.html">ToolkitException</A></CODE> - with the following reason codes: <ul>
      <li><code>UNAVAILABLE_ELEMENT</code> in case of unavailable SMS TPDU or Cell Broadcast Page TLV element or wrong data format </ul></DL>
</DD>
</DL>
<HR>

<A NAME="getSecuredDataLength()"><!-- --></A><H3>
getSecuredDataLength</H3>
<PRE>
public short <B>getSecuredDataLength</B>()
                           throws <A HREF="../../sim/toolkit/ToolkitException.html">ToolkitException</A></PRE>
<DL>
<DD>Looks for the length of the Secured Data from the Command Packet in the first SMS TPDU
 or Cell Broadcast Page Simple TLV contained in the Envelope handler. This can be used
 on the events:
 - EVENT_FORMATTED_SMS_PP_ENV, EVENT_FORMATTED_SMS_PP_UPD, if the SMS TP-UD
 is formatted according to GSM03.48 Single Short Message.
 - EVENT_FORMATTED_SMS_CB, if the Cell Broadcast Page is formatted according to GSM 03.48.    
 If the element is available it becomes the TLV selected.<DD><DL>
<DT><B>Returns:</B><DD>the length of the Secured Data contained in the first SMS TPDU or Cell Broadcast Page TLV element (without padding bytes). If the Secured Data length is zero, no exception shall be thrown.<DT><B>Throws:</B><DD><CODE><A HREF="../../sim/toolkit/ToolkitException.html">ToolkitException</A></CODE> - with the following reason codes: <ul>
      <li><code>UNAVAILABLE_ELEMENT</code> in case of unavailable SMS TPDU or Cell Broadcast Page TLV element or wrong data format </ul></DL>
</DD>
</DL>
<HR>

<A NAME="getItemIdentifier()"><!-- --></A><H3>
getItemIdentifier</H3>
<PRE>
public byte <B>getItemIdentifier</B>()
                       throws <A HREF="../../sim/toolkit/ToolkitException.html">ToolkitException</A></PRE>
<DL>
<DD>Returns the item identifier byte value from the first Item Identifier TLV
 element in the current Envelope data field.
 If the element is available it becomes the TLV selected.<DD><DL>
<DT><B>Returns:</B><DD>item identifier<DT><B>Throws:</B><DD><CODE><A HREF="../../sim/toolkit/ToolkitException.html">ToolkitException</A></CODE> - with the following reason codes: <ul>
      <li><code>UNAVAILABLE_ELEMENT</code> in case of unavailable TLV element
      <li><code>OUT_OF_TLV_BOUNDARIES</code> if the item identifier byte is missing in the Item Identifier Simple TLV </ul></DL>
</DD>
</DL>
<!-- ========= END OF CLASS DATA ========= -->
<HR>

<!-- ========== START OF NAVBAR ========== -->
<A NAME="navbar_bottom"><!-- --></A>
<TABLE BORDER="0" WIDTH="100%" CELLPADDING="1" CELLSPACING="0">
<TR>
<TD COLSPAN=2 BGCOLOR="#EEEEFF" CLASS="NavBarCell1">
<A NAME="navbar_bottom_firstrow"><!-- --></A>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="3">
  <TR ALIGN="center" VALIGN="top">
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../overview-summary.html"><FONT CLASS="NavBarFont1"><B>Overview</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-summary.html"><FONT CLASS="NavBarFont1"><B>Package</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#FFFFFF" CLASS="NavBarCell1Rev"> &nbsp;<FONT CLASS="NavBarFont1Rev"><B>Class</B></FONT>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="class-use/EnvelopeHandler.html"><FONT CLASS="NavBarFont1"><B>Use</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-tree.html"><FONT CLASS="NavBarFont1"><B>Tree</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../deprecated-list.html"><FONT CLASS="NavBarFont1"><B>Deprecated</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../index-all.html"><FONT CLASS="NavBarFont1"><B>Index</B></FONT></A>&nbsp;</TD>
  </TR>
</TABLE>
</TD>
<TD ALIGN="right" VALIGN="top" ROWSPAN=3><EM>
</EM>
</TD>
</TR>

<TR>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
&nbsp;<A HREF="../../sim/toolkit/EditHandler.html"><B>PREV CLASS</B></A>&nbsp;
&nbsp;<A HREF="../../sim/toolkit/EnvelopeResponseHandler.html"><B>NEXT CLASS</B></A></FONT></TD>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
  <A HREF="../../index.html" TARGET="_top"><B>FRAMES</B></A>  &nbsp;
&nbsp;<A HREF="EnvelopeHandler.html" TARGET="_top"><B>NO FRAMES</B></A></FONT></TD>
</TR>
<TR>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
  SUMMARY: &nbsp;INNER&nbsp;|&nbsp;FIELD&nbsp;|&nbsp;CONSTR&nbsp;|&nbsp;<A HREF="#method_summary">METHOD</A></FONT></TD>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
DETAIL: &nbsp;FIELD&nbsp;|&nbsp;CONSTR&nbsp;|&nbsp;<A HREF="#method_detail">METHOD</A></FONT></TD>
</TR>
</TABLE>
<!-- =========== END OF NAVBAR =========== -->

<HR>

</BODY>
</HTML>
